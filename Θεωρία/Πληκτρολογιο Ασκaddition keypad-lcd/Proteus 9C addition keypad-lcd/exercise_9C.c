#include <main-proteus.h>
#include <keypad-proteus.h> // ��������� ��������� ��� ������������ 4�4
         //�������!!! � ����� B ��������������� ��� �� 
         //������������. �� ��������� �� ������� ��� ���������
         // ��� ������ keypad.h. ������� �� �� �� notepad ��� 
         //��������� ���� �������� ��� ��������� �� ��� 
         //��������������� ��� ������.
#include <flex_lcd-proteus.h> //��������� ��������� �� ����� LCD ��� �������
         //�������!!! � ����� D ��������������� ��� ��� ������� ���
         //������. �� ��������� �� ������� ��� ���������
         // ��� ������ flex_lcd.h. ������� �� �� �� notepad ��� 
         //��������� ���� �������� ��� ��������� �� ���
         //��������������� ��� ������.
#byte PORTB=0xf81  //���� ��� ���������� ��������� ��� ������ �
#byte PORTD=0xf83  // ���� ��� ���������� ��������� ��� ������ D

// ������ ����������
char state=1;
int N1=0;
int N2=0;
int sum;

// ������ ��������, �����������
void init(void);


//����� ���������
void main()
{
char k; // ��������� char ��� ���������� ��� ASCII ������ ��� ��������
   // ��� ��������
init();  // ������������, � ��������� ������������� ���� ������ ��� �����
lcd_init(); //������������ ��� ������ lcd.
kbd_init(); // ������������ ��� ���������� ��������� ��� �� ������������

while(TRUE)     {   // ���������� ������� ���� ������
      
      switch(state)   {
      case 1:
         k=kbd_getc();
         if(k!=0)
         {
         N1=k&0b00001111;
         printf(lcd_putc,"%1d+",N1);
         state=2;
         break;
         }
         break;
      case 2 :
         k=kbd_getc();
         if(k!=0)
         {
         N2=k&0b00001111;
         printf(lcd_putc,"%1d=",N2);
         sum=N2+N1;
         printf(lcd_putc,"%2d",sum);
         state=1;
            delay_ms(2000);
            lcd_putc("\f");
            break;
}  //������� �� while(k!=0)
}//������� �� switch(state)
      } //������� � ������ ��� while(TRUE)
} // ������� � ������ ��� main

// ������� ��� ���������� �������������
void init(void){
set_tris_d(0x00); // � ����� D ������� ������, ��������������� ��� ��� �������
          // ��� ������ LCD
           }

